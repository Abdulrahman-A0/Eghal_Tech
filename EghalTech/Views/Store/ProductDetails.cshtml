@model ProductDetailsViewModel
@{
    ViewData["Title"] = $"{Model.Product.Name} - EghalTech Store";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" href="~/css/store-product.css">
</head>
<body>
    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <div class="product-layout">
                <!-- Product Images -->
                <div class="product-images">
                    <div class="main-image-container">
                        <img id="mainImage" src="~/img/product/@Model.Product.ImageUrl" alt="@Model.Product.Name" class="main-image">
                    </div>
                </div>

                <!-- Product Info -->
                <div class="product-info">
                    <div class="product-badges">
                        <span class="brand-badge">@Model.Product.Brand</span>
                        <span class="category-badge">@Model.Product.Category.Name</span>
                    </div>

                    <h1 class="product-title">@Model.Product.Name</h1>

                    <div class="rating-section">
                        <div class="stars" data-rating="@Model.AverageRating">
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star"></i>
                        </div>
                        <span class="rating-value">@Model.AverageRating.ToString("F1")</span>
                        <span class="review-count">(@Model.ReviewCount reviews)</span>
                    </div>

                    <div class="price-section">
                        <span class="current-price">$@Model.Product.Price.ToString("F2")</span>
                    </div>

                    <div class="product-status">
                        <div class="status-item">
                            <i class="bi bi-check-circle text-success"></i>
                            <span>In Stock (@Model.Product.StockQuantity available)</span>
                        </div>
                        <div class="status-item">
                            <i class="bi bi-truck text-primary"></i>
                            <span>Free shipping on orders over $50</span>
                        </div>
                        <div class="status-item">
                            <i class="bi bi-shield-check text-info"></i>
                            <span>1-year warranty included</span>
                        </div>
                    </div>
                        <div class="quantity-cart-section">
                        <button class="add-to-cart-btn" onclick="AddToCart(@Model.Product.Id,this)">
                            <i class="bi bi-cart-plus"></i>
                            Add to Cart
                        </button>

                        <button class="action-btn wishlist-btn full-btn
                        @(Model.IsInWishList ? "active" : "")"
                                onclick="addToWishList(@Model.Product.Id, this)">
                            <i class="bi @(Model.IsInWishList ? "bi-heart-fill" : "bi-heart")"></i>
                        </button>

                        </div>
                </div>
            </div>

            <!-- Product Details Tabs -->
            <div class="product-tabs">
                <div class="tab-navigation">
                    <button class="tab-btn active" data-tab="description">Description</button>
                    <button class="tab-btn" data-tab="reviews">Reviews (@Model.ReviewCount)</button>
                </div>

                <div class="tab-content">
                    <!-- Description Tab -->
                    <div id="description" class="tab-panel active">
                            <div class="description-text">
                                <h3>Product Description</h3>
                                <p>@Model.Product.Description</p>

                                <h4>Key Features:</h4>
                                <ul class="features-list">
                                    <li>
                                        <i class="bi bi-check"></i> Lorem ipsum dolor sit amet consectetur adipisicing elit. Veritatis perspiciatis numquam, voluptatum beatae magnam sed possimus sit obcaecati quis ea natus error ad cupiditate voluptatibus quidem rem nemo temporibus corporis.</li>
                                    <li>
                                        <i class="bi bi-check"></i> Lorem ipsum dolor sit amet consectetur adipisicing elit. Quis eius porro, mollitia, in earum, vitae dolores consectetur dolorum blanditiis nulla exercitationem? At voluptatum quod facilis quis cupiditate sequi placeat autem.
                                    </li>
                                    <li>
                                        <i class="bi bi-check"></i> Lorem ipsum dolor sit amet consectetur adipisicing elit. Neque distinctio atque odit deleniti minima? Quod sapiente blanditiis sunt dolorum? Iste sit minus cumque a eum tempora ut aliquid officia nam?	<!-- Start Header Area -->
                                    </li>
                                    <li>
                                        <i class="bi bi-check"></i> Lorem ipsum dolor sit amet consectetur adipisicing elit. Neque distinctio atque odit deleniti minima? Quod sapiente blanditiis sunt dolorum? Iste sit minus cumque a eum tempora ut aliquid officia nam?	<!-- Start Header Area -->
                                    </li>
                                    <li>
                                        <i class="bi bi-check"></i> Lorem ipsum dolor sit amet consectetur adipisicing elit. Neque distinctio atque odit deleniti minima? Quod sapiente blanditiis sunt dolorum? Iste sit minus cumque a eum tempora ut aliquid officia nam?	<!-- Start Header Area -->
                                    </li>
                                </ul>
                            </div>
                    </div>

                    <!-- Reviews Tab -->
                    <div id="reviews" class="tab-panel">
                        <!-- Review Summary -->
                        <div class="review-summary">
                            <div class="rating-overview">
                                <div class="overall-rating">
                                    <span class="rating-number">@Model.AverageRating.ToString("F1")</span>
                                    <div class="stars" data-rating="@Model.AverageRating">
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star-fill"></i>
                                        <i class="bi bi-star"></i>
                                    </div>
                                    <span class="total-reviews">Based on @Model.ReviewCount reviews</span>
                                </div>
                                <div class="rating-breakdown">
                                    @for (int i = 5; i >= 1; i--)
                                    {
                                        var count = Model.Reviews.Count(r => r.Rating == i);
                                        var percentage = Model.ReviewCount > 0 ? (count * 100.0 / Model.ReviewCount) : 0;
                                        <div class="rating-bar">
                                            <span class="rating-label">@i★</span>
                                            <div class="bar-container">
                                                <div class="bar-fill" style="width: @percentage%"></div>
                                            </div>
                                            <span class="rating-count">@count</span>
                                        </div>
                                    }
                                </div>
                            </div>
                            <button class="write-review-btn" onclick="showReviewForm()">Write a Review</button>
                        </div>

                        <!-- Review Form -->
                        <div id="reviewForm" class="review-form" style="display: none;">
                            <h3>Write Your Review</h3>
                            <partial name="_ReviewForm" model="new ReviewFormViewModel{ProductId=Model.Product.Id}"></partial>
                        </div>

                        <!-- Reviews List -->
                        <div class="reviews-list">
                            @foreach (var review in Model.Reviews.OrderByDescending(r => r.CreatedAt))
                            {
                                <div class="review-item">
                                    <div class="review-header">
                                        <div class="reviewer-info">
                                            <span class="reviewer-name">@review.User.Name</span>
                                        </div>
                                        <div class="review-meta">
                                            <div class="stars" data-rating="@review.Rating">
                                                @for (int i = 1; i <= 5; i++)
                                                {
                                                    <i class="@(i <= review.Rating ? "bi bi-star-fill" : "bi bi-star")"></i>
                                                }
                                            </div>
                                            <span class="review-date">@review.CreatedAt.ToString("MMM dd, yyyy")</span>
                                        </div>
                                    </div>
                                    <p class="review-comment">@review.Comment</p>
                                    <div class="review-actions">
                                        
                                    </div>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    
</body>
@section Scripts{
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/js/store-product.js"></script>
    <script src="~/js/home.js"></script>
}

</html>
